<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Welcome to WelDX IIW 2021 AA’s documentation!" href="index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.05.06 -->
        <title>2021 IIW Annual Assembly C-XII - WelDX IIW 2021 AA documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">WelDX IIW 2021 AA  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">WelDX IIW 2021 AA  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">2021 IIW Annual Assembly C-XII</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/iiw2021_CXII_fabry_cagtay_01.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="iiw-annual-assembly-c-xii">
<h1>2021 IIW Annual Assembly C-XII<a class="headerlink" href="#iiw-annual-assembly-c-xii" title="Link to this heading">¶</a></h1>
<p>This notebook is an extended interactive version of the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> features and example dataset presented at the <strong>2021 IIW Annual Assembly C-XII</strong> meeting.</p>
<p>The code of this notebook can be found here: <a class="reference external" href="https://github.com/BAMWelDX/IIW2021_AA_CXII">https://github.com/BAMWelDX/IIW2021_AA_CXII</a></p>
<p>You can launch this notebook as an interactive binder session in your browser following this link: <br />
<a class="reference external" href="https://mybinder.org/v2/gh/BAMWelDX/IIW2021_AA_CXII/main?urlpath=lab/tree/iiw2021_CXII_fabry_cagtay_01.ipynb">https://mybinder.org/v2/gh/BAMWelDX/IIW2021_AA_CXII/main?urlpath=lab/tree/iiw2021_CXII_fabry_cagtay_01.ipynb</a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">weldx</span></code> documentation and code is available online:<br />
<a class="reference external" href="https://weldx.readthedocs.io/en/latest/">https://weldx.readthedocs.io/en/latest/</a> <br />
<a class="reference external" href="https://github.com/BAMWelDX/weldx">https://github.com/BAMWelDX/weldx</a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">weldx</span></code> documentation and GitHub links for this specific code version <code class="docutils literal notranslate"><span class="pre">v0.6.9</span></code> can be found here:<br />
<a class="reference external" href="https://weldx.readthedocs.io/en/v0.6.9/index.html">https://weldx.readthedocs.io/en/v0.6.9/index.html</a> <br />
<a class="reference external" href="https://github.com/BAMWelDX/weldx/tree/v0.6.9">https://github.com/BAMWelDX/weldx/tree/v0.6.9</a></p>
<section id="process-video">
<h2>Process Video<a class="headerlink" href="#process-video" title="Link to this heading">¶</a></h2>
<p>To give an ovierview of this welding example, here is a video recording of the welding experiment conducted at BAM.</p>
<p>We can see the pre- and post-welding scan of the workpiece geometry as well as the position of the temperature measurements.</p>
<video controls src="./_static/WID417.avi" /></section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">¶</a></h2>
<p>We start with some general python package imports used throughout this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">weldx</span><span class="w"> </span><span class="kn">import</span> <span class="n">Q_</span><span class="p">,</span> <span class="n">WeldxFile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">weldx.asdf.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_schema_path</span><span class="p">,</span> <span class="n">view_tree</span>

<span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pprint</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">pprint</span>
</pre></div>
</div>
</div>
</div>
<p>Some helper functions for this notebook are included in the <code class="docutils literal notranslate"><span class="pre">helpers.py</span></code> file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># default plotting styles</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">helpers</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">ax_setup</span><span class="p">,</span>
    <span class="n">build_base_csm</span><span class="p">,</span>
    <span class="n">create_geometry</span><span class="p">,</span>
    <span class="n">cs_colors</span><span class="p">,</span>
    <span class="n">plot_gmaw</span><span class="p">,</span>
    <span class="n">plot_measurements</span><span class="p">,</span>
    <span class="n">plot_signal</span><span class="p">,</span>
    <span class="n">welding_wire_geo_data</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="opening-the-file">
<h2>1. Opening the file<a class="headerlink" href="#opening-the-file" title="Link to this heading">¶</a></h2>
<p>We define the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> filename that contains the data used for this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;./single_pass_weld.weldx&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>To get an overview of the file contents we can use the <code class="docutils literal notranslate"><span class="pre">view_tree</span></code> function of the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> library to create an interactive tree view.</p>
<p>Try searching for a specific term like <code class="docutils literal notranslate"><span class="pre">wire_feedrate</span></code> using the <em><strong>Filter…</strong></em> box in the upper right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_tree</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IPython.core.display.JSON object&gt;
</pre></div>
</div>
</div>
</div>
<p>To open and access the example dataset we will use the <code class="docutils literal notranslate"><span class="pre">WeldxFile</span></code> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wx_file</span> <span class="o">=</span> <span class="n">WeldxFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">sync</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>You can find more infos about handling <code class="docutils literal notranslate"><span class="pre">weldx</span></code> files in the tutorial: https://weldx.readthedocs.io/en/latest/tutorials/weldxfile.html</p>
<p>The file is expected to validate against the schema <code class="docutils literal notranslate"><span class="pre">single_pass_weld-0.1.0.yaml</span></code>.<br />
The schema ensures that all elements of the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> file pass the requirements defined in the schema, including:</p>
<ul class="simple">
<li><p>all requirement entries are present in the file:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">workpiece</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TCP</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">welding_current</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">welding_voltage</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">measurement</span> <span class="pre">chains</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">equipment</span></code></p></li>
</ul>
</li>
<li><p>all entries and objects stored in the file have the correct type</p></li>
<li><p>all additional restrictions defined in <code class="docutils literal notranslate"><span class="pre">single_pass_weld-0.1.0.yaml</span></code> are met</p></li>
</ul>
<p>The details describing the schema requirements can be found here: https://weldx.readthedocs.io/en/v0.5.0/generated/datamodels/single_pass_weld-0.1.0.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_schema</span> <span class="o">=</span> <span class="n">get_schema_path</span><span class="p">(</span><span class="s2">&quot;single_pass_weld-0.1.0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We open the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> file and run a validation agains the <code class="docutils literal notranslate"><span class="pre">single_pass_weld-0.1.0.yaml</span></code> schema.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">WeldxFile</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">custom_schema</span><span class="o">=</span><span class="n">file_schema</span><span class="p">,</span>
    <span class="n">sync</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">asdffile_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;copy_arrays&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">wx_file</span> <span class="o">=</span> <span class="n">file</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/micromamba/envs/weldx/lib/python3.11/site-packages/asdf/_asdf.py:189: AsdfWarning: copy_arrays is deprecated; use memmap instead. Note that memmap will default to False in asdf 4.0.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<p>We can now access and explore the contents of the file interactively in our notebook.</p>
</section>
<section id="general-metadata">
<h2>2. General metadata<a class="headerlink" href="#general-metadata" title="Link to this heading">¶</a></h2>
<p>First let’s look at some general simple metadata stored in the WelDX-file.</p>
<p>The (optional) <code class="docutils literal notranslate"><span class="pre">reference_timestamp</span></code> field is used to indicate the start time of the experiment (the moment of arc ignition). All time data that is not given as absolute time are interpreted as relative to the given reference time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wx_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reference_timestamp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2021-03-17 11:06:42.334400&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can deduce the total runtime of the experiment from the TCP movement of the welding.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;TCP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time:
DatetimeIndex([&#39;2021-03-17 11:06:42.334400&#39;, &#39;2021-03-17 11:07:23.667733333&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
reference time: 2021-03-17 11:06:42.334400
</pre></div>
</div>
</div>
</div>
<p>The <strong>WelDX</strong> standard introduces the <code class="docutils literal notranslate"><span class="pre">wx_user</span></code> field to store user specific content.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wx_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wx_user&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;WID&#39;: 417, &#39;operator&#39;: &#39;C. Schippereit&#39;, &#39;project&#39;: &#39;WelDX presentation&#39;}
</pre></div>
</div>
</div>
</div>
<p>We define a time index from start to end of the experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;TCP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">as_timedelta_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="workpiece-definition">
<h2>3. Workpiece definition<a class="headerlink" href="#workpiece-definition" title="Link to this heading">¶</a></h2>
<p>The file schema mandates that the user provides workpiece information with the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base_metal</span></code> referenced by a common name and the associated standard</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">geometry</span></code> consisting of a groove description following ISO 9692-1 and the seam length</p></li>
</ul>
<p>Here is how this information is stored the <code class="docutils literal notranslate"><span class="pre">workpiece</span></code> entry of the example dataset <code class="docutils literal notranslate"><span class="pre">weldx</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">workpiece</span><span class="p">:</span>
<span class="w">  </span><span class="nt">base_metal</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">common_name</span><span class="p">:</span><span class="w"> </span><span class="nv">S355J2+N</span><span class="p p-Indicator">,</span><span class="nt"> standard</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;DIN</span><span class="nv"> </span><span class="s">EN</span><span class="nv"> </span><span class="s">10225-2:2011&#39;</span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="nt">geometry</span><span class="p">:</span>
<span class="w">    </span><span class="nt">groove_shape</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!groove/iso_9692_1_2013_12/VGroove-0.1.0</span>
<span class="w">      </span><span class="nt">t</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/quantity-0.1.0</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="nt"> units</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/units-0.1.0</span><span class="w"> </span><span class="nv">millimeter</span><span class="p p-Indicator">}</span>
<span class="w">      </span><span class="nt">alpha</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/quantity-0.1.0</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="nv">45</span><span class="p p-Indicator">,</span><span class="nt"> units</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/units-0.1.0</span><span class="w"> </span><span class="nv">degree</span><span class="p p-Indicator">}</span>
<span class="w">      </span><span class="nt">b</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/quantity-0.1.0</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nt"> units</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/units-0.1.0</span><span class="w"> </span><span class="nv">millimeter</span><span class="p p-Indicator">}</span>
<span class="w">      </span><span class="nt">c</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/quantity-0.1.0</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nt"> units</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/units-0.1.0</span><span class="w"> </span><span class="nv">millimeter</span><span class="p p-Indicator">}</span>
<span class="w">      </span><span class="nt">code_number</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1.3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;1.5&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">seam_length</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/quantity-0.1.0</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="nv">350</span><span class="p p-Indicator">,</span><span class="nt"> units</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!units/units-0.1.0</span><span class="w"> </span><span class="nv">millimeter</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<section id="workpiece-material">
<h3>workpiece material<a class="headerlink" href="#workpiece-material" title="Link to this heading">¶</a></h3>
<p>Since we know exactly where to find the information in the file, we can access the metadata directly for all files that validate against the file schema.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;workpiece&quot;</span><span class="p">][</span><span class="s2">&quot;base_metal&quot;</span><span class="p">][</span><span class="s2">&quot;common_name&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;S355J2+N&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;workpiece&quot;</span><span class="p">][</span><span class="s2">&quot;base_metal&quot;</span><span class="p">][</span><span class="s2">&quot;standard&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;DIN EN 10225-2:2011&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="seam-length">
<h3>seam length<a class="headerlink" href="#seam-length" title="Link to this heading">¶</a></h3>
<p>The total seam length of the workpiece is also stored.<br />
As throughout most of the functionality of the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> API, physical units must be used where appropriate to avoid ambiguity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seam_length</span> <span class="o">=</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;workpiece&quot;</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;seam_length&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">seam_length</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>350 mm
</pre></div>
</div>
</div>
</div>
</section>
<section id="welding-groove">
<h3>welding groove<a class="headerlink" href="#welding-groove" title="Link to this heading">¶</a></h3>
<p>The groove shape will be loaded into a specific <code class="docutils literal notranslate"><span class="pre">weldx</span></code> type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groove</span> <span class="o">=</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;workpiece&quot;</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;groove_shape&quot;</span><span class="p">]</span>
<span class="nb">str</span><span class="p">(</span><span class="n">groove</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;VGroove(t=&lt;Quantity(8, &#39;millimeter&#39;)&gt;, alpha=&lt;Quantity(45, &#39;degree&#39;)&gt;, c=&lt;Quantity(1, &#39;millimeter&#39;)&gt;, b=&lt;Quantity(1, &#39;millimeter&#39;)&gt;, code_number=[&#39;1.3&#39;, &#39;1.5&#39;])&quot;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">weldx</span></code> API includes convinient functions to create and visualize different welding groove shapes.<br />
Many examples and details are available in this tutorial: https://weldx.readthedocs.io/en/v0.5.0/tutorials/groove_types_01.html</p>
<p>To get a picture of the groove shape we can simply call the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groove</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/pint_xarray/conversion.py:323,</span> in <span class="ni">convert_units</span><span class="nt">(obj, units)</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">323</span>     <span class="n">new_obj</span> <span class="o">=</span> <span class="n">call_on_dataset</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span>         <span class="n">convert_units_dataset</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">temporary_name</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span> <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/pint_xarray/compat.py:13,</span> in <span class="ni">call_on_dataset</span><span class="nt">(func, obj, name, *args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">ds</span> <span class="o">=</span> <span class="n">obj</span>
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/pint_xarray/conversion.py:307,</span> in <span class="ni">convert_units_dataset</span><span class="nt">(obj, units)</span>
<span class="g g-Whitespace">    </span><span class="mi">306</span> <span class="k">if</span> <span class="n">failed</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">307</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">failed</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span> <span class="n">reordered</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">converted</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>

<span class="ne">ValueError</span>: {(&#39;s&#39;,): ValueError(&#39;cannot convert non-quantified index&#39;)}

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">groove</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/decorator.py:235,</span> in <span class="ni">decorate.&lt;locals&gt;.fun</span><span class="nt">(*args, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">kwsyntax</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span>     <span class="n">args</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">fix</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">235</span> <span class="k">return</span> <span class="n">caller</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">extras</span> <span class="o">+</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/util/util.py:439,</span> in <span class="ni">check_matplotlib_available</span><span class="nt">(func, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Matplotlib is unavailable (module set to None).&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="k">return</span>
<span class="ne">--&gt; </span><span class="mi">439</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/welding/groove/iso_9692_1.py:147,</span> in <span class="ni">IsoBaseGroove.plot</span><span class="nt">(self, title, axis_label, raster_width, show_params, axis, grid, line_style, ax, show_area)</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span> <span class="k">if</span> <span class="n">raster_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span>     <span class="n">raster_width</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">_DEFAULT_LEN_UNIT</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">147</span> <span class="n">profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_profile</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span> <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="n">title</span> <span class="o">=</span> <span class="n">_groove_type_to_name</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">]</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/welding/groove/iso_9692_1.py:366,</span> in <span class="ni">VGroove.to_profile</span><span class="nt">(self, width_default)</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span> <span class="n">y_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_value</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span> <span class="n">segment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">366</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_translate_reflect</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">segment_list</span><span class="p">,</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/welding/groove/iso_9692_1.py:225,</span> in <span class="ni">IsoBaseGroove._translate_reflect</span><span class="nt">(b, segment_list, x_value, y_value)</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span> <span class="nd">@staticmethod</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span> <span class="k">def</span><span class="w"> </span><span class="nf">_translate_reflect</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">segment_list</span><span class="p">,</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">225</span>     <span class="n">shape</span> <span class="o">=</span> <span class="n">_helperfunction</span><span class="p">(</span><span class="n">segment_list</span><span class="p">,</span> <span class="p">(</span><span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>     <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">_DEFAULT_LEN_UNIT</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span>     <span class="c1"># y-axis as mirror axis</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/welding/groove/iso_9692_1.py:1650,</span> in <span class="ni">_helperfunction</span><span class="nt">(segment, array)</span>
<span class="g g-Whitespace">   </span><span class="mi">1647</span>         <span class="n">segment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seg</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1648</span>         <span class="n">counter</span> <span class="o">+=</span> <span class="mi">2</span>
<span class="ne">-&gt; </span><span class="mi">1650</span> <span class="k">return</span> <span class="n">geo</span><span class="o">.</span><span class="n">Shape</span><span class="p">(</span><span class="n">segment_list</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/geometry.py:909,</span> in <span class="ni">Shape.__init__</span><span class="nt">(self, segments)</span>
<span class="g g-Whitespace">    </span><span class="mi">896</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Construct a shape.</span>
<span class="g g-Whitespace">    </span><span class="mi">897</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">898</span><span class="sd"> Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">906</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">907</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">908</span> <span class="n">segments</span> <span class="o">=</span> <span class="n">_to_list</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">909</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_segments_connected</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">910</span> <span class="bp">self</span><span class="o">.</span><span class="n">_segments</span> <span class="o">=</span> <span class="n">segments</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/geometry.py:935,</span> in <span class="ni">Shape._check_segments_connected</span><span class="nt">(segments)</span>
<span class="g g-Whitespace">    </span><span class="mi">923</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Check if all segments are connected to each other.</span>
<span class="g g-Whitespace">    </span><span class="mi">924</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">925</span><span class="sd"> The start point of a segment must be identical to the end point of</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">932</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">933</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">934</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">935</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">_vector_is_close</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">point_end</span><span class="p">,</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point_start</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Segments are not connected.&quot;</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/pint/registry_helpers.py:293,</span> in <span class="ni">wraps.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper</span><span class="nt">(*values, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">287</span> <span class="c1"># In principle, the values are used as is</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span> <span class="c1"># When then extract the magnitudes when needed.</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span> <span class="n">new_values</span><span class="p">,</span> <span class="n">new_kw</span><span class="p">,</span> <span class="n">values_by_name</span> <span class="o">=</span> <span class="n">converter</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span>     <span class="n">ureg</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">strict</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">293</span> <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">new_values</span><span class="p">,</span> <span class="o">**</span><span class="n">new_kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span> <span class="k">if</span> <span class="n">is_ret_container</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>     <span class="n">out_units</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span>         <span class="n">_replace_units</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">values_by_name</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_ref</span> <span class="k">else</span> <span class="n">r</span>
<span class="g g-Whitespace">    </span><span class="mi">298</span>         <span class="k">for</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">is_ref</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ret</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>     <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/geometry.py:271,</span> in <span class="ni">DynamicShapeSegment.point_end</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span> <span class="nd">@property</span>
<span class="g g-Whitespace">    </span><span class="mi">268</span> <span class="nd">@UREG</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">_DEFAULT_LEN_UNIT</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">269</span> <span class="k">def</span><span class="w"> </span><span class="nf">point_end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Get the end point of the segment.&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">271</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_points</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_coord</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/geometry.py:246,</span> in <span class="ni">DynamicBaseSegment.get_points</span><span class="nt">(self, positions)</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Get an array of the points at the specified relative positions.</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">235</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">244</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">245</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">246</span>     <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_series</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_series</span><span class="o">.</span><span class="n">position_dim_name</span><span class="p">:</span> <span class="n">positions</span><span class="p">})</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span>     <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">data_array</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/core/generic_series.py:497,</span> in <span class="ni">GenericSeries.evaluate</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">495</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expression</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">496</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_expr</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">497</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_array</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/core/generic_series.py:542,</span> in <span class="ni">GenericSeries._evaluate_array</span><span class="nt">(self, coords)</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span>     <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_array</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span>         <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; is not a valid dimension.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">542</span>     <span class="n">ut</span><span class="o">.</span><span class="n">xr_interp_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="n">da2</span><span class="o">=</span><span class="n">eval_args</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interpolation</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">543</span> <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/weldx/util/xarray.py:356,</span> in <span class="ni">xr_interp_like</span><span class="nt">(da1, da2, interp_coords, broadcast_missing, fillna, method, assume_sorted)</span>
<span class="g g-Whitespace">    </span><span class="mi">349</span> <span class="c1"># convert base array units to indexer units</span>
<span class="g g-Whitespace">    </span><span class="mi">350</span> <span class="c1"># (needed for the indexing later and it will happen during interpolation anyway)</span>
<span class="g g-Whitespace">    </span><span class="mi">351</span> <span class="n">base_units</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">352</span>     <span class="n">c</span><span class="p">:</span> <span class="n">da_temp</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">UNITS_KEY</span><span class="p">)</span>
<span class="nn">    353     for c</span> in <span class="ni">da1.coords.keys() &amp; da_temp.coords.keys</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span>     <span class="k">if</span> <span class="n">UNITS_KEY</span> <span class="ow">in</span> <span class="n">da1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="p">}</span>
<span class="ne">--&gt; </span><span class="mi">356</span> <span class="n">da1</span> <span class="o">=</span> <span class="n">da1</span><span class="o">.</span><span class="n">pint</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="o">**</span><span class="n">base_units</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> <span class="c1"># make sure edge coordinate values of da1 are in new coordinate axis of da_temp</span>
<span class="g g-Whitespace">    </span><span class="mi">359</span> <span class="n">da_temp</span> <span class="o">=</span> <span class="n">_add_coord_edges</span><span class="p">(</span><span class="n">da1</span><span class="o">=</span><span class="n">da1</span><span class="p">,</span> <span class="n">da2</span><span class="o">=</span><span class="n">da_temp</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="n">assume_sorted</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/pint_xarray/accessors.py:592,</span> in <span class="ni">PintDataArrayAccessor.to</span><span class="nt">(self, units, **unit_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">586</span>         <span class="s2">&quot;units must be either a string, a pint.Unit object or a dict-like,&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span>         <span class="sa">f</span><span class="s2">&quot; but got </span><span class="si">{</span><span class="n">units</span><span class="si">!r}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">590</span> <span class="n">units</span> <span class="o">=</span> <span class="n">either_dict_or_kwargs</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">unit_kwargs</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">592</span> <span class="k">return</span> <span class="n">conversion</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">da</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/weldx/lib/python3.11/site-packages/pint_xarray/conversion.py:331,</span> in <span class="ni">convert_units</span><span class="nt">(obj, units)</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>     <span class="k">if</span> <span class="n">temporary_name</span> <span class="ow">in</span> <span class="n">failed</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">failed</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">failed</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">temporary_name</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">331</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">format_error_message</span><span class="p">(</span><span class="n">failed</span><span class="p">,</span> <span class="s2">&quot;convert&quot;</span><span class="p">))</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span> <span class="k">return</span> <span class="n">new_obj</span>

<span class="ne">ValueError</span>: Cannot convert variables:
    <span class="n">incompatible</span> <span class="n">units</span> <span class="k">for</span> <span class="n">variable</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,):</span> <span class="n">cannot</span> <span class="n">convert</span> <span class="n">non</span><span class="o">-</span><span class="n">quantified</span> <span class="n">index</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-geometry">
<h3>3D Geometry<a class="headerlink" href="#d-geometry" title="Link to this heading">¶</a></h3>
<p>With all the metadata of the workpiece available, it is easy to visualize a simple 3D model of the specimen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geometry</span> <span class="o">=</span> <span class="n">create_geometry</span><span class="p">(</span><span class="n">groove</span><span class="p">,</span> <span class="n">seam_length</span><span class="p">,</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">))</span>
<span class="n">geometry</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile_raster_width</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">),</span> <span class="n">trace_raster_width</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">))</span>
<span class="n">ax_setup</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="welding-tcp-movement-description">
<h2>4. Welding TCP movement description<a class="headerlink" href="#welding-tcp-movement-description" title="Link to this heading">¶</a></h2>
<p>The path of the welding wire along the weld seam is given by the <code class="docutils literal notranslate"><span class="pre">TCP</span></code> property.</p>
<p>The weld path is a linear movement between two points at a constant weld speed. The TCP reference frame is the workpiece base coordinate system, starting at the beginning of the weld seam. The x-axis coordinates will indicate the start- and end-point of the welding process along the workpiece length. The y- and z-coordinates determine the position of the TCP in relation to the cross-sectional groove plane.</p>
<p>The information is stored in a <a class="reference external" href="https://weldx.readthedocs.io/en/v0.5.0/_autosummary/weldx.transformations.LocalCoordinateSystem.html#weldx.transformations.LocalCoordinateSystem">LocalCoordinateSystem</a> instance with two points and the start and end time relative to the <code class="docutils literal notranslate"><span class="pre">reference_timestamp</span></code>.</p>
<p>The YAML section of the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> file describing the TCP movement looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">TCP</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!core/transformations/local_coordinate_system-0.1.0</span>
<span class="w">  </span><span class="nt">reference_time</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!time/timestamp-0.1.0</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2021-03-17T11:06:42.334400</span>
<span class="w">  </span><span class="nt">time</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!time/timedeltaindex-0.1.0</span>
<span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="kt">!core/ndarray-1.0.0</span>
<span class="w">      </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">41333333333</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">datatype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int64</span>
<span class="w">      </span><span class="nt">shape</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!time/timedelta-0.1.0</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">P0DT0H0M0S</span>
<span class="w">    </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!time/timedelta-0.1.0</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">P0DT0H0M41.333333333S</span>
<span class="w">    </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!time/timedelta-0.1.0</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">P0DT0H0M0S</span>
<span class="w">    </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!time/timedelta-0.1.0</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">P0DT0H0M41.333333333S</span>
<span class="w">  </span><span class="nt">coordinates</span><span class="p">:</span><span class="w"> </span><span class="kt">!weldx!core/variable-0.1.0</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">coordinates</span>
<span class="w">    </span><span class="nt">dimensions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">time</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">c</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">dtype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;f8</span>
<span class="w">    </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="kt">!core/ndarray-1.0.0</span>
<span class="w">      </span><span class="nt">data</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">20.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.0</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">330.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.0</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">datatype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">float64</span>
<span class="w">      </span><span class="nt">shape</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> section of the coordiantes describe the start end end point in 3D space: <code class="docutils literal notranslate"><span class="pre">[20.0,</span> <span class="pre">0.0,</span> <span class="pre">3.0]</span></code> to <code class="docutils literal notranslate"><span class="pre">[330.0,</span> <span class="pre">0.0,</span> <span class="pre">3.0]</span></code> .
Therefor the welded part of the workpiece will extend from 20 mm to 330 mm of the joint. The offset in z-direction is 3 mm from the workpiece bottom.</p>
<p>We can create a <code class="docutils literal notranslate"><span class="pre">CoordinateSystemManager</span></code> instance and add the movement of the welding TCP to the geometry plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm_base</span> <span class="o">=</span> <span class="n">build_base_csm</span><span class="p">(</span><span class="n">wx_file</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">csm_base</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">reference_system</span><span class="o">=</span><span class="s2">&quot;workpiece&quot;</span><span class="p">,</span>
    <span class="n">coordinate_systems</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TCP weld&quot;</span><span class="p">],</span>
    <span class="n">data_sets</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;workpiece (simple)&quot;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="n">cs_colors</span><span class="p">,</span>
    <span class="n">show_wireframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_data_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax_setup</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="process-description">
<h2>5. Process description<a class="headerlink" href="#process-description" title="Link to this heading">¶</a></h2>
<p>The arc welding process must be defined using the following properties:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">process</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">  </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">    </span><span class="nt">welding_process</span><span class="p">:</span>
<span class="w">      </span><span class="nt">$ref</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;asdf://weldx.bam.de/weldx/schemas/process/GMAW-0.1.0&quot;</span>
<span class="w">    </span><span class="nt">shielding_gas</span><span class="p">:</span>
<span class="w">      </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;asdf://weldx.bam.de/weldx/tags/aws/process/shielding_gas_for_procedure-0.1.*&quot;</span>
<span class="w">    </span><span class="nt">weld_speed</span><span class="p">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">welding_wire</span><span class="p">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">welding_process</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">shielding_gas</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">weld_speed</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">welding_wire</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>We can store the process property in a new variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">process</span> <span class="o">=</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;process&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The weld speed is restricted to a constant value of dimension “[length]/[time]”</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">weld_speed</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;asdf://weldx.bam.de/weldx/tags/core/time_series-0.1.*&quot;</span>
<span class="w">  </span><span class="nt">wx_unit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;m/s&quot;</span>
<span class="w">  </span><span class="nt">wx_shape</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="p">[</span><span class="s2">&quot;weld_speed&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The welding wire is described by the constant diameter and a string describing the classification.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">welding_wire</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">  </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">    </span><span class="nt">diameter</span><span class="p">:</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">The diameter of the welding wire.</span>
<span class="w">      </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;asdf://weldx.bam.de/weldx/tags/units/quantity-0.1.*&quot;</span>
<span class="w">      </span><span class="nt">wx_unit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;m&quot;</span>
<span class="w">      </span><span class="nt">wx_shape</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">class</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</pre></div>
</div>
<p>Additional metadata can be stored in the <code class="docutils literal notranslate"><span class="pre">wx_user</span></code> field if necessary. In the example, a G4Si1 wire with 1.2 mm diameter was used. The manufacturer and charge number are also given.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">process</span><span class="p">[</span><span class="s2">&quot;welding_wire&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The shielding gas information consists of a common name and the gas mixture.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">process</span><span class="p">[</span><span class="s2">&quot;shielding_gas&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">torch_shielding_gas</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># switch to static plots</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">welding_process</span></code> describes the parameters set at the welding power source during the course of the experiment.</p>
<p>Parameters are represented by a <a class="reference external" href="https://weldx.readthedocs.io/en/v0.5.0/tutorials/timeseries_01.html"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> object and can vary over time. In this example, all parameters are set to constant values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gmaw_process</span> <span class="o">=</span> <span class="n">process</span><span class="p">[</span><span class="s2">&quot;welding_process&quot;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_gmaw</span><span class="p">(</span><span class="n">gmaw_process</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="measurements">
<h2>6. Measurements<a class="headerlink" href="#measurements" title="Link to this heading">¶</a></h2>
<p>We can list all measurements stored in the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;measurements&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can also create a plot showing all signals stored in the measurement chains listed under <code class="docutils literal notranslate"><span class="pre">measurements</span></code>.</p>
<p>In the example dataset the welding current and voltage are recorded during the welding process. The temperature-measurements are recorded before and after the welding experiment. Due to the use of reference times, all signals can be synchronized.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_measurements</span><span class="p">(</span><span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;measurements&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># switch to interactive plots</span>
<span class="o">%</span><span class="k">matplotlib</span> widget
</pre></div>
</div>
</div>
</div>
<p>Plot the voltage measurement:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_signal</span><span class="p">(</span><span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;welding_voltage&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;welding_voltage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the current meausurement:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_signal</span><span class="p">(</span><span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;welding_current&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;welding_current&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here is a detailed look at the current waveform:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_signal</span><span class="p">(</span><span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;welding_current&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;welding_current&quot;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mf">23.025</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="measurement-chains">
<h2>7. Measurement chains<a class="headerlink" href="#measurement-chains" title="Link to this heading">¶</a></h2>
<p>To document how a welding related measurement was conducted, we can describe and store measurement chains using the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> API.
This includes:</p>
<ul class="simple">
<li><p>describing the measurement equipment</p></li>
<li><p>describing multiple transformation steps from raw-data to the final measurement</p></li>
<li><p>providing information about measurement uncertainties and errors</p></li>
<li><p>attaching certification examples or similar files</p></li>
</ul>
<p>An in depth example describing measurement chains can be found in the documentation: <a class="reference external" href="https://weldx.readthedocs.io/en/v0.5.0/tutorials/measurement_example.html">meassurement_example</a></p>
<section id="current-measurement-chain">
<h3>current measurement chain<a class="headerlink" href="#current-measurement-chain" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_measurement_chain</span> <span class="o">=</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;measurements&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">measurement_chain</span>

<span class="n">current_source</span> <span class="o">=</span> <span class="n">current_measurement_chain</span><span class="o">.</span><span class="n">source</span>
<span class="nb">print</span><span class="p">(</span><span class="n">current_source</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="k">for</span> <span class="n">processor</span> <span class="ow">in</span> <span class="n">current_measurement_chain</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">processor</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Each measurement chain object can be visualized with it’s plot function. The squared nodes represent signals, the circular nodes show data that is present for a single signal. Transformation steps between signals are given with name and some info.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># switch to static plots</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;measurements&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">measurement_chain</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;measurements&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">measurement_chain</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;measurements&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">measurement_chain</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="coordinate-systems">
<h2>8. coordinate systems<a class="headerlink" href="#coordinate-systems" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">weldx</span></code> API contains multiple functions to describe dependencies and transformations between multiple different coordinate systems.</p>
<ul class="simple">
<li><p>translations and rotations</p></li>
<li><p>constant and time dependent transformations</p></li>
<li><p>transformation between different systems</p></li>
<li><p>grouping multiple systems into subsystems</p></li>
<li><p>transforming spatial data between different coordinate systems</p></li>
<li><p>visualization of transformations and systems</p></li>
</ul>
<p>There are multiple tutorials available covering coordinate transformations using the <code class="docutils literal notranslate"><span class="pre">LocalCoordinateSystem</span></code> and <code class="docutils literal notranslate"><span class="pre">CoordinateSystemManager</span></code> classes:</p>
<ul class="simple">
<li><p>https://weldx.readthedocs.io/en/v0.5.0/tutorials/transformations_01_coordinate_systems.html</p></li>
<li><p>https://weldx.readthedocs.io/en/v0.5.0/tutorials/transformations_02_coordinate_system_manager.html</p></li>
<li><p>https://weldx.readthedocs.io/en/v0.5.0/tutorials/transformations_02_coordinate_system_manager.html#Visualizing-the-coordinate-systems-of-the-CSM</p></li>
<li><p>https://weldx.readthedocs.io/en/v0.5.0/tutorials/welding_example_02_weaving.html</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># switch to static plots</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>In addition to the simplified weldment specification, the example dataset contains the complete coordinate system information describing the BAM arc welding setup.</p>
<ul class="simple">
<li><p>the definition of the reference user frame used for robot programming</p></li>
<li><p>the recorded actual TCP movement of the robot</p></li>
<li><p>the movement of a laser line scanner attached to the robot head</p></li>
</ul>
<p>We can load the instance of the coordinate system manager directly from the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> file.<br />
Following the file schema the data can be accessed under the key <code class="docutils literal notranslate"><span class="pre">coordinate_systems</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span> <span class="o">=</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;coordinate_systems&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We can visualize all loaded coordinate systems using the built-in <code class="docutils literal notranslate"><span class="pre">plot</span></code> functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take another look at the weld specimen.</p>
<img src='./_static/WID417_pre.JPG' width="640" /><p>The workpiece coordinate system has it’s origin located at the start of the workpiece at groove center. We can calculate the position of the thermocouple placement in the workpiece coordinate system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span><span class="o">.</span><span class="n">get_cs</span><span class="p">(</span><span class="s2">&quot;T1&quot;</span><span class="p">,</span> <span class="s2">&quot;user_frame&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The second thermocouple is offset by 5 mm from the first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span><span class="o">.</span><span class="n">get_cs</span><span class="p">(</span><span class="s2">&quot;T2&quot;</span><span class="p">,</span> <span class="s2">&quot;T1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following command will calculate the recorded robot TCP movement in reference to the workpiece coordinate system.
Since the robot movement is time dependent, the result will be a time dependent coordiante system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span><span class="o">.</span><span class="n">get_cs</span><span class="p">(</span><span class="s2">&quot;TCP&quot;</span><span class="p">,</span> <span class="s2">&quot;workpiece&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interactive-3d-visualization">
<h2>9. Interactive 3D visualization<a class="headerlink" href="#interactive-3d-visualization" title="Link to this heading">¶</a></h2>
<section id="add-geometry-data-to-csm">
<h3>Add geometry data to CSM<a class="headerlink" href="#add-geometry-data-to-csm" title="Link to this heading">¶</a></h3>
<p>For visualization using the <code class="docutils literal notranslate"><span class="pre">k3d</span></code> backend we create some 3D data from the workpiece description metadata and add it to the <code class="docutils literal notranslate"><span class="pre">CoordinateSystemManager</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geometry_full_width</span> <span class="o">=</span> <span class="n">create_geometry</span><span class="p">(</span><span class="n">groove</span><span class="p">,</span> <span class="n">seam_length</span><span class="p">,</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">))</span>
<span class="n">spatial_data_geo_full</span> <span class="o">=</span> <span class="n">geometry_full_width</span><span class="o">.</span><span class="n">spatial_data</span><span class="p">(</span>
    <span class="n">profile_raster_width</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">),</span> <span class="n">trace_raster_width</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">spatial_data_geo_full</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">spatial_data_geo_full</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>

<span class="n">spatial_data_geo_reduced</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">spatial_data</span><span class="p">(</span>
    <span class="n">profile_raster_width</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">),</span> <span class="n">trace_raster_width</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">csm</span><span class="o">.</span><span class="n">assign_data</span><span class="p">(</span><span class="n">spatial_data_geo_full</span><span class="p">,</span> <span class="s2">&quot;workpiece geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;workpiece&quot;</span><span class="p">)</span>
<span class="n">csm</span><span class="o">.</span><span class="n">assign_data</span><span class="p">(</span><span class="n">spatial_data_geo_reduced</span><span class="p">,</span> <span class="s2">&quot;workpiece geometry (reduced)&quot;</span><span class="p">,</span> <span class="s2">&quot;workpiece&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We also add a 3D model of the welding wire and attach it to the <code class="docutils literal notranslate"><span class="pre">TCP</span></code> coordinate system. The wire model will follow the TCP movement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">welding_wire_diameter</span> <span class="o">=</span> <span class="n">wx_file</span><span class="p">[</span><span class="s2">&quot;process&quot;</span><span class="p">][</span><span class="s2">&quot;welding_wire&quot;</span><span class="p">][</span><span class="s2">&quot;diameter&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">m</span>
<span class="n">csm</span><span class="o">.</span><span class="n">assign_data</span><span class="p">(</span>
    <span class="n">welding_wire_geo_data</span><span class="p">(</span><span class="n">welding_wire_diameter</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="s2">&quot;welding_wire&quot;</span><span class="p">,</span> <span class="s2">&quot;TCP&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here is an example visualization of the experiment design.<br />
The reconstruction is entierly based on the metadata stored inside the <code class="docutils literal notranslate"><span class="pre">weldx</span></code> file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">reference_system</span><span class="o">=</span><span class="s2">&quot;workpiece&quot;</span><span class="p">,</span>
    <span class="n">coordinate_systems</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TCP design&quot;</span><span class="p">,</span> <span class="s2">&quot;T1&quot;</span><span class="p">,</span> <span class="s2">&quot;T2&quot;</span><span class="p">],</span>
    <span class="n">data_sets</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;workpiece geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;welding_wire&quot;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="n">cs_colors</span><span class="p">,</span>
    <span class="n">show_data_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;k3d&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here is the same visualization, this time using only actual measurement data for the plot.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TCP</span></code> motion is taken from the robot recording of the actual TCP during welding operation.<br />
The workpiece data was obtained from a 3D scan of the workpiece data before and after welding. We can switch the pre- and post-weld scan data for the plot by selecting the corresponding datasets <code class="docutils literal notranslate"><span class="pre">scan_0</span></code> or <code class="docutils literal notranslate"><span class="pre">scan_1</span></code> in the following cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">reference_system</span><span class="o">=</span><span class="s2">&quot;workpiece&quot;</span><span class="p">,</span>
    <span class="n">coordinate_systems</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TCP&quot;</span><span class="p">,</span> <span class="s2">&quot;T1&quot;</span><span class="p">,</span> <span class="s2">&quot;T2&quot;</span><span class="p">],</span>
    <span class="n">data_sets</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scan_0&quot;</span><span class="p">,</span> <span class="s2">&quot;scan_1&quot;</span><span class="p">,</span> <span class="s2">&quot;welding_wire&quot;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="n">cs_colors</span><span class="p">,</span>
    <span class="n">show_data_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;k3d&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Cagtay Fabry
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">2021 IIW Annual Assembly C-XII</a><ul>
<li><a class="reference internal" href="#process-video">Process Video</a></li>
<li><a class="reference internal" href="#imports">Imports</a></li>
<li><a class="reference internal" href="#opening-the-file">1. Opening the file</a></li>
<li><a class="reference internal" href="#general-metadata">2. General metadata</a></li>
<li><a class="reference internal" href="#workpiece-definition">3. Workpiece definition</a><ul>
<li><a class="reference internal" href="#workpiece-material">workpiece material</a></li>
<li><a class="reference internal" href="#seam-length">seam length</a></li>
<li><a class="reference internal" href="#welding-groove">welding groove</a></li>
<li><a class="reference internal" href="#d-geometry">3D Geometry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#welding-tcp-movement-description">4. Welding TCP movement description</a></li>
<li><a class="reference internal" href="#process-description">5. Process description</a></li>
<li><a class="reference internal" href="#measurements">6. Measurements</a></li>
<li><a class="reference internal" href="#measurement-chains">7. Measurement chains</a><ul>
<li><a class="reference internal" href="#current-measurement-chain">current measurement chain</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coordinate-systems">8. coordinate systems</a></li>
<li><a class="reference internal" href="#interactive-3d-visualization">9. Interactive 3D visualization</a><ul>
<li><a class="reference internal" href="#add-geometry-data-to-csm">Add geometry data to CSM</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>